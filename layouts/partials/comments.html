<div class="comment-on flex items-center mt-8 capitalize print:hidden">
    <div id="load-giscus" class="inline-block relative">Load<span class='mx-2 opacity-75 hover:opacity-100 cursor-pointer duration-300 ease-in-out'>Giscus</span>or</div>
    <div id="link-to-mastodon" class="flex items-center relative ml-2">discussion on <span class='mx-2 opacity-75 hover:opacity-100 cursor-pointer duration-300 ease-in-out'>Mastodon</span>{{ partial "icon.html" "external-link-alt" }}</div>
</div>
<div id="comments" class=""></div>
<script>
    function loadGiscus() {
        return new Promise((resolve) => {
            const script = document.createElement('script');
            script.src = 'https://giscus.app/client.js';
            script.setAttribute('data-repo', 'eallion/eallion.com');
            script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkyNjI2Njk1MDg=');
            script.setAttribute('data-category', 'Giscus');
            script.setAttribute('data-category-id', 'DIC_kwDOD6gExM4CS9eF');
            script.setAttribute('data-mapping', 'pathname');
            script.setAttribute('data-strict', '1');
            script.setAttribute('data-reactions-enabled', '1');
            script.setAttribute('data-emit-metadata', '0');
            script.setAttribute('data-input-position', 'bottom');
            script.setAttribute('data-lang', 'zh-CN');
            script.setAttribute('data-loading', 'lazy');
            script.setAttribute('crossorigin', 'anonymous');
            script.async = true;

            const htmlElement = document.documentElement;
            if (htmlElement.classList.contains('dark')) {
                script.setAttribute('data-theme', 'dark_dimmed');
            } else {
                script.setAttribute('data-theme', 'light');
            }

            script.addEventListener('load', () => {
                resolve();
            });

            document.getElementById('comments').appendChild(script);
        });
    }

    document.getElementById('load-giscus').addEventListener('click', async () => {
        await loadGiscus();
        document.getElementById('load-giscus').classList.add('hidden');
        document.getElementById('link-to-mastodon').classList.add('mb-8');
    });
</script>
