{{- define "title" }}{{ .Title }} - {{ .Site.Title }}{{ end -}}

{{- define "content" -}}
{{- $params := .Scratch.Get "params" -}}
{{- $toc := $params.toc -}}
{{- if eq $toc true -}}
{{- $toc = .Site.Params.page.toc | default dict -}}
{{- else if eq $toc false -}}
{{- $toc = dict "enable" false -}}
{{- end -}}

<style>
    .page {
        max-width: 1020px !important;
        background-color: transparent;
        padding-top: 0;
        margin: 0 auto;
    }

    [theme="dark"] .page,
    [theme="black"] .page {
        background-color: transparent;
    }

    .loading {
        /* position: absolute; */
        width: 3rem;
        height: 3rem;
        margin: auto;
        margin-top: 2rem;
        /* top: calc(14% - 1.5rem); */
        /* right: calc(50% - 1.5rem); */
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Cg%3E%3CanimateTransform attributeName='transform' type='rotate' from='0 64 64' to='360 64 64' dur='1000ms' repeatCount='indefinite'/%3E%3Cpath d='M64 6.69a57.3 57.3 0 1 1 0 114.61A57.3 57.3 0 0 1 6.69 64' fill='none' stroke='%23404040' stroke-width='12'/%3E%3C/g%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: center center;
        background-color: transparent;
        background-size: min(2.5rem, calc(100% - 0.5rem));
    }

    .movie {
        /* width: 100vw;
        margin-left: calc(50% - 50vw); */
        display: grid;
        grid-gap: 5px;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        margin-top: 5rem;
        min-height: 815px;
    }

    .card {
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        position: relative;
        overflow: hidden;
        border-radius:4px;
    }

    .card:hover .movie-cate {
        opacity: 1;
        transition: all .5s ease;
    }

    .card:hover .movie_details {
        bottom: 0;
        transition: all .5s;
    }

    .card:hover .poster:before {
        bottom: 0;
    }

    .card:hover .poster img {
        filter: blur(2px);
        transform: translateY(-40px);
    }

    .card .poster {
        position: relative;
        overflow: hidden;
        width: 100%;
        padding-bottom: 150%;
        position: relative;
    }

    .card .poster img {
        transition: .5s;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .card .poster:before {
        content: '';
        position: absolute;
        background: linear-gradient(0deg, rgba(0, 0, 0, 0.808) 60%, transparent);
        height: 100%;
        width: 100%;
        z-index: 1;
        bottom: 0;
        bottom: -100%;
        left: 0;
        transition: .5s;
    }

    .movie_details {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: flex-end;
        position: absolute;
        padding: 15px;
        width: 100%;
        height: 82%;
        box-sizing: border-box;
        left: 0;
        bottom: -400px;
        z-index: 2;
        transition: all .4s ease;
    }

    .movie_details h2 {
        color: #fff;
        font-size: 20px;
        margin: 0;
        padding: 0;
    }

    .movie_details h2 a {
        color: #006bee !important;
        text-shadow: -1px -1px 0 white, 1px -1px 0 white, -1px 1px 0 white, 1px 1px 0 white;
    }


    .movie_details h2 a:hover {
        color: #ef3982 !important;
    }

    .movie_details span {
        font-size: .75rem;
        color: #ff9800;
    }

    .movie_details h2 span {
        line-height: 1.5!important;
        display: table-cell;
        vertical-align: top;
    }

    .movie_details h2 span i {
        margin-right: 0.5rem;
    }

    .rating,
    .rating_star,
    .rating_full,
    .rating_empty {
        display: flex;
        align-items: center;
    }

    .rating_star {
        position: relative;
        padding: 0;
        color: #f7f406;
    }


    .rating_empty {
        overflow: hidden;
        position: absolute;
        top: 0;
    }

    .rating_icon {
        fill: currentColor;
        flex-shrink: 0;
    }

    .rating span {
        margin-left: 0.25rem;
    }

    .tags {
        position: relative;
        margin-top: 5px;
    }

    .tags span {
        padding: 2px 5px;
        margin-top: 2px;
        display: inline-block;
        border-radius: 4px;
        color: #fff;
    }

    .tags span:nth-child(1) {
        background-color: #f70661;
    }

    .tags span:nth-child(2) {
        background-color: #7206f7;
    }

    .tags span:nth-child(3) {
        background-color: #f79d06;
    }

    .tags span:nth-child(4) {
        background-color: #06f7a8;
    }

    .tags span:nth-child(5) {
        background-color: #06a5f7;
    }

    .tags span:nth-child(6) {
        background-color: #f70693;
    }

    .tags span:nth-child(7) {
        background-color: #7254f7;
    }

    .tags span:nth-child(8) {
        background-color: #f7e606;
    }

    .tags span:nth-child(9) {
        background-color: #06f76f;
    }

    .tags span:nth-child(10) {
        background-color: #06a5a9;
    }

    .info {
        color: #fff;
    }

    .info p {
        font-size: 0.875rem;
        margin: 15px 0 10px;
        line-height: 1.5 !important;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .star {
        position: relative;
        display: flex;
        align-items: center;
    }

    .star h4 {
        color: #fff;
        margin: 0 !important;
        padding: 0 !important;
        font-size: 20px;
    }

    .star ul {
        padding-left: 0px !important;
        padding: 0;
        margin: 0 !important;
        display: flex;
    }

    .star ul li {
        list-style: none;
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid #fff;
    }

    .star ul li:not(:first-child) {
        margin-left: -10px;
    }

    .star ul li img {
        width: 100%;
    }

    .movie-page {
        padding-top: 0 !important;
        margin: 0 auto !important;
    }

    .movie-title {
        display: flex;
        flex-wrap: wrap;
        align-items: flex-start;
        line-height: 1.6;
        margin: 0rem auto !important;
        color: #fff;
        flex-direction: column;
        max-width: 800px;
    }

    .movie-title .single-title {
        min-height: 2.5rem;
        margin-left: 4rem;
    }

    .movie-title-meta {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        width: 100%;
    }

    .movie-description {
        display: flex;
        align-items: center;
        margin-left: 1.5rem;
    }

    .movie-description a {
        color: #006bee;
        margin: 0 0.5rem;
    }

    .movie-description a:hover {
        color: #ef3982;
        text-decoration: underline;
    }

    .movie-footer {
        width: 100%;
        display: flex;
        justify-content: flex-start;
        align-items: center;
    }

    .search-item {
        display: flex;
        align-items: center;
        padding-right: 10px;
    }

    .search-item::before {
        content: '|';
        position: relative;
        margin: 0 0.25rem;
        color: gray;
        font-size: 0.75rem;
    }

    .search-item svg path {
        fill: white;
    }

    .search-item:hover svg path {
        fill: #006bee;
    }

    .full-screen,
    .original-screen,
    .normal-screen,
    .web-full-screen,
    .browser-full-screen {
        display: flex;
        align-items: center;
    }

    .full-screen {
        gap: 10px;
        font-size: 0.875rem;
        margin-right: 0.5rem;
    }

    .full-screen:hover {
        cursor: pointer;
    }

    .full-screen svg {
        margin-right: 0.25rem;
    }

    .movie-normal {
        width: 100%;
        margin-left: auto;
    }

    .movie-mt {
        margin-top: 0rem;
        width: 100vw;
        margin-left: calc(50% - 50vw);
    }

    .movie-hide-header {
        display: none !important;
    }

    .movie-hide-title {
        display: none;
    }

    .full-screen-btn,
    .toggle-full-screen {
        align-items: center;
        padding: 10px;
        border-radius: 9999px;
        text-align: center;
        cursor: pointer;
        z-index: 9999;
    }

    .full-screen-btn {
        border-width: 1px;
        height: 1.6rem;
        border-color: #ffffffb3;
    }

    .full-screen-btn:hover {
        color: #f5f5f5;
        background: #006bee;
        border-color: #006bee;
    }

    .toggle-full-screen {
        display: none;
        position: fixed;
        top: 10px;
        right: 10px;
        border-width: 4px;
        height: 3rem;
        border-color: #006bee;
        color: #006bee;
        background: #f8f8f8;
    }

    .toggle-full-screen svg {
        margin-right: 0.25rem;
    }

    .exit-full-screen {
        display: flex;
        opacity: 0;
        animation: showButton 0.5s ease forwards;
    }

    .movies_video {
        position: absolute;
        height: auto;
        width: 100%;
        left: 0;
        right: 0;
        top: 0;
        z-index: -10;
        margin-top: 3.5rem;
    }

    .movies_video:after {
        content: '';
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        height: 100%;
        background: linear-gradient(to bottom,rgba(255,255,255,5%) 0%,#f8fafd 100%)
    }

    [theme="dark"] .movies_video:after {
        background: linear-gradient(to bottom,rgba(255,255,255,5%) 0%,#28292a 100%)
    }

    [theme="black"] .movies_video:after {
        background: linear-gradient(to bottom,rgba(255,255,255,5%) 0%,#000 100%)
    }

    .video-source{
        object-fit: cover
    }

    .movies_video_mt {
        margin-top: 0;
    }

    .movie-cate {
        position: absolute;
        top: 0;
        right: 0;
        background: #f99b01;
        padding: 1px 8px;
        font-size: small;
        font-style: italic;
        border-radius: 0 0 0 8px;
        text-transform: capitalize;
        opacity: 0;
        color: #fff;
    }

    .min-height-auto {
        min-height: unset;
    }

    @keyframes showButton {
        from {
            opacity: 0;
            transform: translateX(100%);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    #loadMoreButton{
        margin: 1rem auto;
        width: 196px;
        text-align: center;
    }

    .category-item {
        color: #696969;
        background-color: #f4f4f4;
        font-size: .9rem;
        padding: 0.25rem 0.75rem;
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
        font-weight: inherit;
        border-radius: 0.25rem;
        transition: 150ms ease;
        cursor: pointer;
    }

    .category-item:first-child {
        margin-left: 1.5rem;
    }

    .category-item.is-active {
        background-color: #006bee;
        color: #fff;
    }

    .category-item:hover {
        background-color: #006bee;
        color: #fff;
    }

    .category {
        padding-top: 2rem;
        display: flex;
        flex-wrap: wrap;
        max-width: 800px;
        margin: auto;
    }

    .category.u-hide + .db--list {
        padding-top: 10px;
    }

    .category_hidden {
        display: none;
    }

    /* cyber 风格按钮 */
    .cyber-btn {
        --primary: hsl(var(--primary-hue), 99.05%, calc(var(--primary-lightness, 58.63) * 1%));
        --shadow-primary: hsl(var(--shadow-primary-hue), 92%, 55%);
        --primary-hue: 349.38deg;
        --primary-lightness: 58.63;
        --color: hsl(0, 0%, 100%);
        --font-size: 1rem;
        --shadow-primary-hue: 178;
        --label-size: 5px;
        --shadow-secondary-hue: 60;
        --shadow-secondary: hsl(var(--shadow-secondary-hue), 90%, 60%);
        --clip: polygon(0 0, 100% 0, 100% 100%, 95% 100%, 95% 90%, 85% 90%, 85% 100%, 8% 100%, 0 70%);
        --border: 4px;
        --shimmy-distance: 5;
        --clip-one: polygon(0 2%, 100% 2%, 100% 95%, 95% 95%, 95% 90%, 85% 90%, 85% 95%, 8% 95%, 0 70%);
        --clip-two: polygon(0 78%, 100% 78%, 100% 100%, 95% 100%, 95% 90%, 85% 90%, 85% 100%, 8% 100%, 0 78%);
        --clip-three: polygon(0 44%, 100% 44%, 100% 54%, 95% 54%, 95% 54%, 85% 54%, 85% 54%, 8% 54%, 0 54%);
        --clip-four: polygon(0 0, 100% 0, 100% 0, 95% 0, 95% 0, 85% 0, 85% 0, 8% 0, 0 0);
        --clip-five: polygon(0 0, 100% 0, 100% 0, 95% 0, 95% 0, 85% 0, 85% 0, 8% 0, 0 0);
        --clip-six: polygon(0 40%, 100% 40%, 100% 85%, 95% 85%, 95% 85%, 85% 85%, 85% 85%, 8% 85%, 0 70%);
        --clip-seven: polygon(0 63%, 100% 63%, 100% 80%, 95% 80%, 95% 80%, 85% 80%, 85% 80%, 8% 80%, 0 70%);
        font-family: 'Cyber', sans-serif;
        color: var(--color);
        cursor: pointer;
        background: transparent;
        text-transform: uppercase;
        font-size: var(--font-size);
        outline: transparent;
        letter-spacing: 2px;
        position: relative;
        font-weight: 700;
        border: 0;
        min-width: 196px;
        height: 35px;
        line-height: 35px;
        transition: background 0.2s;
    }

    .cyber-btn:hover {
        --primary: hsl(var(--primary-hue), 85%, calc(var(--primary-lightness, 50) * 0.8%));
    }

    .cyber-btn:active {
        --primary: hsl(var(--primary-hue), 85%, calc(var(--primary-lightness, 50) * 0.6%));
    }

    .cyber-btn:after,
    .cyber-btn:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        clip-path: var(--clip);
        z-index: -1;
    }

    .cyber-btn:before {
        background: var(--shadow-primary);
        transform: translate(var(--border), 0);
    }

    .cyber-btn:after {
        background: var(--primary);
    }

    .cyber-btn__tag {
        position: absolute;
        padding: 1px 2px;
        letter-spacing: 1px;
        line-height: 1;
        bottom: -5%;
        right: 5%;
        font-weight: normal;
        color: hsl(0, 0%, 0%);
        font-size: var(--label-size);
    }

    .cyber-btn__glitch {
        position: absolute;
        top: calc(var(--border) * -1);
        left: calc(var(--border) * -1);
        right: calc(var(--border) * -1);
        bottom: calc(var(--border) * -1);
        background: var(--shadow-primary);
        text-shadow: 2px 2px var(--shadow-primary), -2px -2px var(--shadow-secondary);
        clip-path: var(--clip);
        animation: glitch 2s infinite;
        display: none;
    }

    .cyber-btn:hover .cyber-btn__glitch {
        display: block;
    }

    .cyber-btn__glitch:before {
        content: '';
        position: absolute;
        top: calc(var(--border) * 1);
        right: calc(var(--border) * 1);
        bottom: calc(var(--border) * 1);
        left: calc(var(--border) * 1);
        clip-path: var(--clip);
        background: var(--primary);
        z-index: -1;
    }

    @keyframes glitch {
        0% {
            clip-path: var(--clip-one);
        }

        2%,
        8% {
            clip-path: var(--clip-two);
            transform: translate(calc(var(--shimmy-distance) * -1%), 0);
        }

        6% {
            clip-path: var(--clip-two);
            transform: translate(calc(var(--shimmy-distance) * 1%), 0);
        }

        9% {
            clip-path: var(--clip-two);
            transform: translate(0, 0);
        }

        10% {
            clip-path: var(--clip-three);
            transform: translate(calc(var(--shimmy-distance) * 1%), 0);
        }

        13% {
            clip-path: var(--clip-three);
            transform: translate(0, 0);
        }

        14%,
        21% {
            clip-path: var(--clip-four);
            transform: translate(calc(var(--shimmy-distance) * 1%), 0);
        }

        25% {
            clip-path: var(--clip-five);
            transform: translate(calc(var(--shimmy-distance) * 1%), 0);
        }

        30% {
            clip-path: var(--clip-five);
            transform: translate(calc(var(--shimmy-distance) * -1%), 0);
        }

        35%,
        45% {
            clip-path: var(--clip-six);
            transform: translate(calc(var(--shimmy-distance) * -1%));
        }

        40% {
            clip-path: var(--clip-six);
            transform: translate(calc(var(--shimmy-distance) * 1%));
        }

        50% {
            clip-path: var(--clip-six);
            transform: translate(0, 0);
        }

        55% {
            clip-path: var(--clip-seven);
            transform: translate(calc(var(--shimmy-distance) * 1%), 0);
        }

        60% {
            clip-path: var(--clip-seven);
            transform: translate(0, 0);
        }

        31%,
        61%,
        100% {
            clip-path: var(--clip-four);
        }
    }

    .cyber-btn:nth-of-type(2) {
        --primary-hue: 260;
    }

    /* // 页面宽度大于700小于900样式 */
    @media screen and (min-width:700px) and (max-width:900px){
        .movie{
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            min-height: 615px;
            margin-top: 3rem;
        }

        .rating,
        .tags,
        .info,
        .movie-footer,
        .full-screen {
            display: none;
        }
    }

    /* // 页面宽度小于700样式 */
    @media (max-width:700px){
        .movie{
            width: 100%;
            margin-left:0;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            min-height: 495px;
            margin-top: 0.5rem;
        }
        .category-item:first-child {
            margin-left: 0;
        }
        .rating,
        .tags,
        .info,
        .movie-footer,
        .full-screen {
            display: none;
        }
    }
</style>

<div class="movies_video">
    <video
        class="video-source"
        id="TopGif"
        width="100%"
        height="100%"
        webkit-playsinline="true"
        x-webkit-airplay="true"
        playsinline="true"
        x5-video-player-type="h5"
        x5-video-orientation="h5"
        x5-video-player-fullscreen="true"
        preload="auto"
        autoplay="true"
        loop=""
        muted=""
        >
        <source src="" type="video/webm" />
        <source src="" type="video/mp4" />
    </video>
</div>

<script>
    //背景随机视频
    document.addEventListener("DOMContentLoaded", function () {
        const videoElement = document.querySelector(".video-source");
        const videoSource = videoElement.querySelector("source");

        const videosName = [
            'meetyourself_1',
            'meetyourself_2',
            'meetyourself_3',
            'meetyourself_4',
            'meetyourself_5',
            'meetyourself_6',
            'meetyourself_7',
            'meetyourself_8',
            // 'inception',
            'interstellar'
        ];

        function playRandomVideo(videos) {
            let randomIndex = Math.floor(Math.random() * videos.length);
            let name = videos[randomIndex];

            // 检查localStorage中的上次播放的视频名称
            const   lastMovieVideoName = localStorage.getItem('  lastMovieVideoName');

            // 如果新视频与上一个视频相同，则继续随机选择，直到找到不同的视频
            while (name ===   lastMovieVideoName) {
                randomIndex = Math.floor(Math.random() * videos.length);
                name = videos[randomIndex];
            }

            const webmSrc = '/assets/video/movie/' + name + '.webm';
            const mp4Src = '/assets/video/movie/' + name + '.mp4';

            const webmSource = videoElement.querySelector('source[type="video/webm"]');
            const mp4Source = videoElement.querySelector('source[type="video/mp4"]');
            webmSource.setAttribute('src', webmSrc);
            mp4Source.setAttribute('src', mp4Src);

            videoElement.load();

            // 将当前播放的视频名称存储在localStorage中
            localStorage.setItem('  lastMovieVideoName', name);
        }

        playRandomVideo(videosName);
    });
</script>
<article class="page single special">
    <div class="movie-title">
        <h1 class="single-title animate__animated animate__pulse animate__faster tiktok-shake">
            <span>{{ .Title }}</span>
            <span data-title="{{ .Title }}"></span>
            <span data-title="{{ .Title }}"></span>
            <span data-title="{{ .Title }}"></span>
        </h1>
        <div class="movie-title-meta">
            <div class="movie-description">{{ T `movie_desc` | safeHTML }}</div>
            <div class="full-screen">
                <div class="normal-screen full-screen-btn"><svg xmlns="http://www.w3.org/2000/svg" width="0.875rem" height="0.875rem" viewBox="0 0 24 24"><path fill="currentColor" d="M14 10V4h2v2.59l3.29-3.29l1.41 1.41L17.41 8H20v2zM4 10V8h2.59l-3.3-3.29l1.42-1.42L8 6.59V4h2v6zm16 4v2h-2.59l3.29 3.29l-1.41 1.41L16 17.41V20h-2v-6zm-10 0v6H8v-2.59l-3.29 3.3l-1.42-1.42L6.59 16H4v-2z"/></svg>{{ T `movie_normal` | safeHTML }}</div>
                <div class="web-full-screen full-screen-btn"><svg xmlns="http://www.w3.org/2000/svg" width="0.875rem" height="0.875rem" viewBox="0 0 24 24"><path fill="currentColor" d="M21 3v6h-2V6.41l-3.29 3.3l-1.42-1.42L17.59 5H15V3zM3 3v6h2V6.41l3.29 3.3l1.42-1.42L6.41 5H9V3zm18 18v-6h-2v2.59l-3.29-3.29l-1.41 1.41L17.59 19H15v2zM9 21v-2H6.41l3.29-3.29l-1.41-1.42L5 17.59V15H3v6z"/></svg>{{ T `movie_web_full_screen` | safeHTML }}</div>
                <div class="browser-full-screen full-screen-btn"><svg xmlns="http://www.w3.org/2000/svg" width="0.875rem" height="0.875rem" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M18.5 5.5H16a1.5 1.5 0 0 1 0-3h3A2.5 2.5 0 0 1 21.5 5v3a1.5 1.5 0 0 1-3 0zM8 5.5H5.5V8a1.5 1.5 0 1 1-3 0V5A2.5 2.5 0 0 1 5 2.5h3a1.5 1.5 0 1 1 0 3m0 13H5.5V16a1.5 1.5 0 0 0-3 0v3A2.5 2.5 0 0 0 5 21.5h3a1.5 1.5 0 0 0 0-3m8 0h2.5V16a1.5 1.5 0 0 1 3 0v3a2.5 2.5 0 0 1-2.5 2.5h-3a1.5 1.5 0 0 1 0-3"/></g></svg>{{ T `movie_browser_full_screen` | safeHTML }}</div>
            </div>
        </div>
    </div>
    <div class="toggle-full-screen"><svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 20 20"><path fill="currentColor" d="M3.4 2L2 3.4l2.8 2.8L3 8h5V3L6.2 4.8zm11.8 4.2L18 3.4L16.6 2l-2.8 2.8L12 3v5h5zM4.8 13.8L2 16.6L3.4 18l2.8-2.8L8 17v-5H3zM17 12h-5v5l1.8-1.8l2.8 2.8l1.4-1.4l-2.8-2.8z"/></svg>{{ T `movie_exit_full_screen` | safeHTML }}</div>
    <div id="content" class="content movies">
        <div class="category">
            <span class="category-item is-active" data-category="all">{{ T `movie_cate_all` | safeHTML }}</span>
            <span class="category-item" data-category="movie">{{ T `movie_cate_movie` | safeHTML }}</span>
            <span class="category-item" data-category="tv">{{ T `movie_cate_tv` | safeHTML }}</span>
            <span class="category-item" data-category="book">{{ T `movie_cate_book` | safeHTML }}</span>
            <span class="category-item" data-category="music">{{ T `movie_cate_music` | safeHTML }}</span>
            <span class="category-item" data-category="game">{{ T `movie_cate_game` | safeHTML }}</span>
            <span class="category-item" data-category="podcast">{{ T `movie_cate_podcast` | safeHTML }}</span>
        </div>
        <div class="loading"></div>
        <div id="movie" class="movie"></div>
        <div id="loadMoreButton" type="button" class="cyber-btn">
            {{ T `movie_loadmore` | safeHTML }}<span aria-hidden>_</span>
            <span aria-hidden class="cyber-btn__glitch">{{ T `movie_loadmore` | safeHTML }}_</span>
            <span aria-hidden class="cyber-btn__tag">e5n</span>
        </div>
    </div>
</article>

<script>
    let currentPage = 1;
    let totalPages = 0;
    let currentCategory = 'all';
    const content = document.getElementById('movie');
    const loadMoreButton = document.getElementById('loadMoreButton');
    const genreItems = document.querySelectorAll('.category-item');

    async function fetchData(page, category) {
        try {
            let url = `https://neodb.eallion.com/api?page=${page}`;
            if (category !== 'all') {
                url += `&category=${category}`;
            }
            const response = await fetch(url);
            const data = await response.json();
            const loading = document.querySelector('.loading');
                loading.classList.add('hidden');
            return data;
        } catch (error) {
            console.error('Error fetching data:', error);
        }
    }

    function displayData(data) {
        data.data.forEach(item => {
            let categoryIcon = '';
            let categorySearch = '';
            switch (item.item.category) {
                case 'movie':
                    categoryIcon = '<i class="fas fa-film fa-fw"></i> Film';
                    categorySearch = `<a href="https://xiaoya.eallion.com/search?box=${item.item.display_title}&url=&type=video" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线播放" title="在线播放">
                                <svg t="1703688181681" class="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8794" width="28" height="28"><path d="M896 224c0-70.6-57.4-128-128-128H192c-70.6 0-128 57.4-128 128v64h832v-64zM64 352v384c0 70.6 57.4 128 128 128h416.9C569 826.9 544 773.9 544 715.3 544 603.2 635.2 512 747.3 512c58.7 0 111.6 25 148.7 64.9V352H64z m465.8 225.2l-97.2 56.1c-21.3 12.3-48-3.1-48-27.7V493.4c0-24.6 26.7-40 48-27.7l97.2 56.1c21.3 12.3 21.3 43.1 0 55.4z" p-id="8795" fill="#ffffff"></path><path d="M950.6 873.4L894 816.8c-1.8-1.8-3.7-3.3-5.7-4.5 19-27.6 30.2-61 30.2-97 0-94.4-76.8-171.3-171.3-171.3S576 620.8 576 715.3s76.8 171.3 171.3 171.3c36 0 69.4-11.2 97-30.2 1.3 2 2.8 3.9 4.5 5.7l56.6 56.6c6.2 6.2 14.4 9.4 22.6 9.4s16.4-3.1 22.6-9.4c12.5-12.6 12.5-32.8 0-45.3z m-203.3-50.9c-59.2 0-107.3-48.1-107.3-107.3S688.1 608 747.3 608s107.3 48.1 107.3 107.3-48.2 107.2-107.3 107.2z" p-id="8796" fill="#ffffff"></path></svg>
                            </a>`;
                    break;
                case 'tv':
                    categoryIcon = '<i class="fas fa-tv fa-fw"></i> TV';
                    categorySearch = `<a href="https://xiaoya.eallion.com/search?box=${item.item.display_title}&url=&type=video" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线播放" title="在线播放">
                                <svg t="1703688181681" class="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8794" width="28" height="28"><path d="M896 224c0-70.6-57.4-128-128-128H192c-70.6 0-128 57.4-128 128v64h832v-64zM64 352v384c0 70.6 57.4 128 128 128h416.9C569 826.9 544 773.9 544 715.3 544 603.2 635.2 512 747.3 512c58.7 0 111.6 25 148.7 64.9V352H64z m465.8 225.2l-97.2 56.1c-21.3 12.3-48-3.1-48-27.7V493.4c0-24.6 26.7-40 48-27.7l97.2 56.1c21.3 12.3 21.3 43.1 0 55.4z" p-id="8795" fill="#ffffff"></path><path d="M950.6 873.4L894 816.8c-1.8-1.8-3.7-3.3-5.7-4.5 19-27.6 30.2-61 30.2-97 0-94.4-76.8-171.3-171.3-171.3S576 620.8 576 715.3s76.8 171.3 171.3 171.3c36 0 69.4-11.2 97-30.2 1.3 2 2.8 3.9 4.5 5.7l56.6 56.6c6.2 6.2 14.4 9.4 22.6 9.4s16.4-3.1 22.6-9.4c12.5-12.6 12.5-32.8 0-45.3z m-203.3-50.9c-59.2 0-107.3-48.1-107.3-107.3S688.1 608 747.3 608s107.3 48.1 107.3 107.3-48.2 107.2-107.3 107.2z" p-id="8796" fill="#ffffff"></path></svg>
                            </a>`;
                    break;
                case 'book':
                    categoryIcon = '<i class="fas fa-book fa-fw"></i> Book';
                    categorySearch = `<a href="https://annas-archive.org/search?q=${item.item.display_title}" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线阅读" title="在线阅读">
                                <svg t="1709798084149" class="" viewBox="0 0 1105 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5377" width="28" height="28"><path d="M647.064511 471.633702a196.014298 196.014298 0 0 0 39.69634-118.277447c0-107.563574-86.440851-194.875915-193.187404-194.875915-106.63217 0-193.187404 87.192511-193.187404 194.875915 0 107.569021 86.440851 194.875915 193.187404 194.875915a191.400851 191.400851 0 0 0 108.712851-33.759319l37.621106 37.953362a30.464 30.464 0 0 0 29.777702 8.034042 31.193872 31.193872 0 0 0 21.809022-22.005106 31.297362 31.297362 0 0 0-7.963234-30.033702l-36.466383-36.787745zM828.889872 833.361702H294.040511c-20.806809 0-38.040511-20.834043-38.040511-46.297872 0-25.32766 17.119319-46.297872 38.040511-46.297873h534.849361c20.812255 0 38.045957 20.834043 38.045958 46.297873 0.669957 25.32766-16.558298 46.297872-38.045958 46.297872z m142.107234-691.537702c24.167489 1.454298 31.21566 17.102979 31.21566 37.893447v741.027404c-1.230979 19.118298-15.550638 37.893447-41.286809 37.893447H218.068426C154.961702 958.638298 103.489362 907.220426 103.489362 844.16817V179.83183C103.489362 116.779574 154.961702 65.361702 218.068426 65.361702H768c84.425532 0 100.765957 89.87234 100.765957 114.382979 0 16.340426-0.386723 169.363064-1.16017 459.073362 0 20.795915-17.119319 38.00783-38.045957 38.007829H218.068426c-20.812255 0-37.931574 17.102979-37.931575 37.898894v130.113362c0 20.795915 17.119319 37.898894 37.931575 37.898893h672.571914a49.021277 49.021277 0 0 0 49.021277-49.021276V179.826383c0-20.790468 8.170213-37.332426 31.335489-38.002383z m-477.249361 343.464851c-72.192 0-130.723404-58.531404-130.723405-130.723404s58.531404-130.723404 130.723405-130.723404 130.723404 58.531404 130.723404 130.723404-58.531404 130.723404-130.723404 130.723404z" fill="#000000" p-id="5378"></path></svg>
                            </a>`;
                    break;
                case 'music':
                    categoryIcon = '<i class="fas fa-music fa-fw"></i> Music';
                    categorySearch = `<a href="https://open.spotify.com/search/${item.item.display_title}" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线试听" title="在线试听">
                                <svg t="1709798195323" class="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6492" width="28" height="28"><path d="M369.066667 928c-221.44 0-315.733333-94.293333-315.733334-315.733333v-243.2c0-221.44 94.293333-315.733333 315.733334-315.733334h243.2c221.44 0 315.733333 94.293333 315.733333 315.733334v157.866666c0 17.493333-14.506667 32-32 32s-32-14.506667-32-32v-157.866666c0-186.026667-65.706667-251.733333-251.733333-251.733334h-243.2c-186.026667 0-251.733333 65.706667-251.733334 251.733334v243.2c0 186.026667 65.706667 251.733333 251.733334 251.733333h157.866666c17.493333 0 32 14.506667 32 32s-14.506667 32-32 32h-157.866666z" fill="#292D32" p-id="6493"></path><path d="M192.853333 553.386667c0-51.626667 42.24-93.866667 93.866667-93.866667 51.626667 0 93.866667 42.24 93.866667 93.866667 0 51.626667-42.24 93.866667-93.866667 93.866666-51.626667 0-93.866667-42.24-93.866667-93.866666z m64 0c0 16.213333 13.226667 29.866667 29.866667 29.866666 16.64 0 29.866667-13.226667 29.866667-29.866666 0-16.64-13.226667-29.866667-29.866667-29.866667-16.213333 0-29.866667 13.226667-29.866667 29.866667z" fill="#292D32" p-id="6494"></path><path d="M316.586667 553.386667V304.64c0-38.826667 24.32-70.4 61.44-80.64l123.733333-33.706667c38.4-10.666667 62.72-0.426667 75.946667 9.813334 13.226667 10.24 29.44 30.72 29.44 70.4V512c0 17.493333-14.506667 32-32 32s-32-14.506667-32-32V270.506667c0-13.653333-2.986667-18.773333-4.266667-19.626667-1.28-0.853333-7.253333-2.56-20.48 0.853333l-123.306667 33.706667c-12.8 3.413333-14.506667 12.373333-14.506666 18.773333v248.746667c0 17.92-14.506667 32.426667-32 32.426667s-32-14.506667-32-32z" fill="#292D32" p-id="6495"></path><path d="M419.413333 512c0-51.626667 42.24-93.866667 93.866667-93.866667 51.626667 0 93.866667 42.24 93.866667 93.866667a93.866667 93.866667 0 0 1-93.866667 93.866667c-51.626667 0-93.866667-42.24-93.866667-93.866667z m64 0.426667c0 16.213333 13.226667 29.866667 29.866667 29.866666 16.64 0 29.866667-13.226667 29.866667-29.866666 0-16.64-13.653333-29.866667-29.866667-29.866667-16.213333 0-29.866667 13.226667-29.866667 29.866667z" fill="#292D32" p-id="6496"></path><path d="M317.866667 385.28a32 32 0 0 1 22.613333-39.253333l226.56-61.866667c17.066667-4.266667 34.56 5.546667 39.253333 22.613333 4.693333 17.066667-5.546667 34.56-22.613333 39.253334L357.12 407.893333c-2.986667 0.426667-5.973333 0.853333-8.533333 0.853334-14.08 0-26.88-9.386667-30.72-23.466667z" fill="#292D32" p-id="6497"></path><path d="M596.906667 771.413333c0-93.013333 75.52-168.533333 168.533333-168.533333s168.533333 75.52 168.533333 168.533333-75.52 168.533333-168.533333 168.533334-168.533333-75.52-168.533333-168.533334z m64 0c0 57.6 46.933333 104.533333 104.533333 104.533334s104.533333-46.933333 104.533333-104.533334-46.933333-104.533333-104.533333-104.533333-104.533333 46.933333-104.533333 104.533333z" fill="#292D32" p-id="6498"></path><path d="M904.96 956.16l-42.666667-42.666667a32.170667 32.170667 0 0 1 0-45.226666c12.373333-12.373333 32.853333-12.373333 45.226667 0l42.666667 42.666666c12.373333 12.373333 12.373333 32.853333 0 45.226667-6.4 5.973333-14.506667 9.386667-22.613334 9.386667s-16.213333-2.986667-22.613333-9.386667z" fill="#292D32" p-id="6499"></path></svg>
                            </a>`;
                    break;
                case 'game':
                    categoryIcon = '<i class="fab fa-steam fa-fw"></i> Game';
                    categorySearch = `<a href="https://store.steampowered.com/search/?term=${item.item.display_title}" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线游玩" title="在线游玩">
                                <svg t="1709798925636" class="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4277" width="28" height="28"><path d="M512.213333 85.333333c-224 0-407.722667 172.8-425.130666 392.405334l228.693333 94.549333a120.448 120.448 0 0 1 67.968-20.992c2.261333 0 4.48 0.128 6.698667 0.213333l101.717333-147.285333v-2.090667c0-88.746667 72.106667-160.853333 160.853333-160.853333a161.109333 161.109333 0 0 1 160.853334 160.938667c0 88.746667-72.149333 160.896-160.853334 160.896h-3.712l-144.938666 103.509333c0 1.834667 0.128 3.754667 0.128 5.674667A120.576 120.576 0 0 1 384 793.045333a121.344 121.344 0 0 1-118.4-96.981333l-163.754667-67.797333C152.490667 807.338667 316.928 938.666667 512.256 938.666667c235.605333 0 426.581333-191.018667 426.581333-426.666667 0-235.605333-191.018667-426.666667-426.624-426.666667zM302.08 711.125333c9.301333 19.285333 25.386667 35.498667 46.72 44.416a90.709333 90.709333 0 0 0 118.613333-118.186666 90.581333 90.581333 0 0 0-115.712-50.261334l54.144 22.442667a66.773333 66.773333 0 0 1-51.370666 123.264l-52.394667-21.674667z m458.24-309.12a107.349333 107.349333 0 0 0-107.221333-107.178666 107.221333 107.221333 0 1 0 107.221333 107.178666zM653.312 321.28A80.64 80.64 0 0 1 733.866667 401.834667a80.64 80.64 0 0 1-80.554667 80.554666 80.512 80.512 0 1 1 0-161.109333z" p-id="4278"></path></svg>
                            </a>`;
                    break;
                case 'podcast':
                    categoryIcon = '<i class="fas fa-podcast fa-fw"></i> Podcast';
                    categorySearch = `<a href="https://open.spotify.com/search/${item.item.display_title}" target="_blank" rel="noreferrer noopener nofollow" aria-label="play" alt="在线收听" title="在线收听">
                                <svg t="1709818177671" class="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5314" width="28" height="28"><path d="M768 128H256C185.429333 128 128 185.429333 128 256v512c0 70.570667 57.429333 128 128 128h512c70.570667 0 128-57.429333 128-128V256c0-70.570667-57.429333-128-128-128z m-213.12 651.904c-7.68 22.101333-28.757333 30.762667-42.88 30.762667s-35.2-8.661333-42.88-30.762667c-7.68-22.101333-21.12-98.602667-21.12-149.888S493.397333 576 512 576s64 2.773333 64 54.016c0 51.285333-13.482667 127.786667-21.12 149.888zM458.666667 480a53.333333 53.333333 0 1 1 106.666666 0 53.333333 53.333333 0 0 1-106.666666 0zM512 362.666667c-70.570667 0-128 57.429333-128 128 0 34.304 13.738667 65.365333 35.797333 88.362666a103.04 103.04 0 0 0-13.482666 44.586667C367.018667 592.298667 341.333333 544.682667 341.333333 490.666667c0-94.122667 76.544-170.666667 170.666667-170.666667s170.666667 76.544 170.666667 170.666667c0 54.016-25.685333 101.632-64.938667 132.949333a103.808 103.808 0 0 0-13.482667-44.586667A127.445333 127.445333 0 0 0 640 490.666667c0-70.570667-57.429333-128-128-128z m99.541333 363.861333c2.218667-16.896 4.096-34.304 5.333334-51.242667C681.301333 638.506667 725.333333 569.984 725.333333 490.666667c0-117.632-95.701333-213.333333-213.333333-213.333334s-213.333333 95.701333-213.333333 213.333334c0 79.317333 44.032 147.84 108.458666 184.618666 1.28 16.938667 3.114667 34.346667 5.333334 51.242667A256.384 256.384 0 0 1 256 490.666667c0-141.184 114.816-256 256-256s256 114.816 256 256a256.384 256.384 0 0 1-156.458667 235.861333z" p-id="5315"></path></svg>
                            </a>`;
                    break;
                case 'album':
                    categoryIcon = '<i class="fas fa-images fa-fw"></i> Album';
                    break;
                case 'performance':
                    categoryIcon = '<i class="fas fa-database fa-fw"></i> Performance';
                    break;
                default:
                    categoryIcon = '<i class="fas fa-database fa-fw"></i> NeoDB';
                }
            const date = new Date(item.created_time);
            const year = date.getFullYear();
            const commentHtml = item.comment_text === null ?
                `<p><i class="fas fa-info-circle"></i> 简介：${item.item.brief}</p>` :
                `<p><i class="fas fa-edit"></i> 短评：${item.comment_text}</p>`;
            const externalResourcesHtml = item.item.external_resources.map(resource => {
                const url = new URL(resource.url);
                const host = url.host;
                if (host === 'eggplant.place') {
                    return '';
                }
                return `<li class="external-resource"><a href="/go/?target=${btoa(String(resource.url))}" target="_blank" rel="noreferrer noopener nofollow"><img src="/assets/images/movie/${host}.png" loading="lazy" alt="${item.item.display_title}" no-view></a></li>`;
            }).join('');

            const html = `

            <div class="card">
                <div class="poster">
                    <img alt="${item.item.display_title}" class="lazy" loading="lazy" data-src="${item.item.cover_image_url}" no-view>
                </div>
                <div class="movie-cate">
                    ${categoryIcon}
                </div>
                <div class="movie_details">
                    <h2><a href="/go/?target=${btoa(String(item.item.id))}" target="_blank" rel="noreferrer noopener nofollow">${item.item.display_title}</a><br><span>${item.item.title} (Star @${year})</span></h2>

                    <div class="rating">
                        <div class="rating_star">
                            <div class="rating_full"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="M235.38 98.53A11.82 11.82 0 0 0 225 90.29l-59.45-5.14a4 4 0 0 1-3.32-2.44L139 27.36a11.95 11.95 0 0 0-22.06 0l-23.2 55.35a4 4 0 0 1-3.32 2.44L31 90.29a12 12 0 0 0-6.83 21.07l45.1 39.35a4 4 0 0 1 1.28 4L57 213.22a11.88 11.88 0 0 0 4.67 12.48a11.76 11.76 0 0 0 13.19.53l51.1-31a3.89 3.89 0 0 1 4.08 0l51.1 31a12 12 0 0 0 17.86-13l-13.52-58.54a4 4 0 0 1 1.28-4l45.1-39.35a11.89 11.89 0 0 0 3.52-12.81m-8.78 6.8l-45.1 39.35a12 12 0 0 0-3.82 11.8L191.2 215a4 4 0 0 1-1.56 4.2a3.86 3.86 0 0 1-4.35.17l-51.1-31a11.88 11.88 0 0 0-12.38 0l-51.1 31a3.86 3.86 0 0 1-4.35-.17a4 4 0 0 1-1.56-4.2l13.52-58.54a12 12 0 0 0-3.82-11.8l-45.1-39.33a4 4 0 0 1-1.18-4.33a4 4 0 0 1 3.44-2.75l59.45-5.14a12 12 0 0 0 10-7.31l23.22-55.36a4 4 0 0 1 7.32 0l23.22 55.36a12 12 0 0 0 10 7.31l59.45 5.14a4 4 0 0 1 3.44 2.75a4 4 0 0 1-1.16 4.33"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="M235.38 98.53A11.82 11.82 0 0 0 225 90.29l-59.45-5.14a4 4 0 0 1-3.32-2.44L139 27.36a11.95 11.95 0 0 0-22.06 0l-23.2 55.35a4 4 0 0 1-3.32 2.44L31 90.29a12 12 0 0 0-6.83 21.07l45.1 39.35a4 4 0 0 1 1.28 4L57 213.22a11.88 11.88 0 0 0 4.67 12.48a11.76 11.76 0 0 0 13.19.53l51.1-31a3.89 3.89 0 0 1 4.08 0l51.1 31a12 12 0 0 0 17.86-13l-13.52-58.54a4 4 0 0 1 1.28-4l45.1-39.35a11.89 11.89 0 0 0 3.52-12.81m-8.78 6.8l-45.1 39.35a12 12 0 0 0-3.82 11.8L191.2 215a4 4 0 0 1-1.56 4.2a3.86 3.86 0 0 1-4.35.17l-51.1-31a11.88 11.88 0 0 0-12.38 0l-51.1 31a3.86 3.86 0 0 1-4.35-.17a4 4 0 0 1-1.56-4.2l13.52-58.54a12 12 0 0 0-3.82-11.8l-45.1-39.33a4 4 0 0 1-1.18-4.33a4 4 0 0 1 3.44-2.75l59.45-5.14a12 12 0 0 0 10-7.31l23.22-55.36a4 4 0 0 1 7.32 0l23.22 55.36a12 12 0 0 0 10 7.31l59.45 5.14a4 4 0 0 1 3.44 2.75a4 4 0 0 1-1.16 4.33"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="M235.38 98.53A11.82 11.82 0 0 0 225 90.29l-59.45-5.14a4 4 0 0 1-3.32-2.44L139 27.36a11.95 11.95 0 0 0-22.06 0l-23.2 55.35a4 4 0 0 1-3.32 2.44L31 90.29a12 12 0 0 0-6.83 21.07l45.1 39.35a4 4 0 0 1 1.28 4L57 213.22a11.88 11.88 0 0 0 4.67 12.48a11.76 11.76 0 0 0 13.19.53l51.1-31a3.89 3.89 0 0 1 4.08 0l51.1 31a12 12 0 0 0 17.86-13l-13.52-58.54a4 4 0 0 1 1.28-4l45.1-39.35a11.89 11.89 0 0 0 3.52-12.81m-8.78 6.8l-45.1 39.35a12 12 0 0 0-3.82 11.8L191.2 215a4 4 0 0 1-1.56 4.2a3.86 3.86 0 0 1-4.35.17l-51.1-31a11.88 11.88 0 0 0-12.38 0l-51.1 31a3.86 3.86 0 0 1-4.35-.17a4 4 0 0 1-1.56-4.2l13.52-58.54a12 12 0 0 0-3.82-11.8l-45.1-39.33a4 4 0 0 1-1.18-4.33a4 4 0 0 1 3.44-2.75l59.45-5.14a12 12 0 0 0 10-7.31l23.22-55.36a4 4 0 0 1 7.32 0l23.22 55.36a12 12 0 0 0 10 7.31l59.45 5.14a4 4 0 0 1 3.44 2.75a4 4 0 0 1-1.16 4.33"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="M235.38 98.53A11.82 11.82 0 0 0 225 90.29l-59.45-5.14a4 4 0 0 1-3.32-2.44L139 27.36a11.95 11.95 0 0 0-22.06 0l-23.2 55.35a4 4 0 0 1-3.32 2.44L31 90.29a12 12 0 0 0-6.83 21.07l45.1 39.35a4 4 0 0 1 1.28 4L57 213.22a11.88 11.88 0 0 0 4.67 12.48a11.76 11.76 0 0 0 13.19.53l51.1-31a3.89 3.89 0 0 1 4.08 0l51.1 31a12 12 0 0 0 17.86-13l-13.52-58.54a4 4 0 0 1 1.28-4l45.1-39.35a11.89 11.89 0 0 0 3.52-12.81m-8.78 6.8l-45.1 39.35a12 12 0 0 0-3.82 11.8L191.2 215a4 4 0 0 1-1.56 4.2a3.86 3.86 0 0 1-4.35.17l-51.1-31a11.88 11.88 0 0 0-12.38 0l-51.1 31a3.86 3.86 0 0 1-4.35-.17a4 4 0 0 1-1.56-4.2l13.52-58.54a12 12 0 0 0-3.82-11.8l-45.1-39.33a4 4 0 0 1-1.18-4.33a4 4 0 0 1 3.44-2.75l59.45-5.14a12 12 0 0 0 10-7.31l23.22-55.36a4 4 0 0 1 7.32 0l23.22 55.36a12 12 0 0 0 10 7.31l59.45 5.14a4 4 0 0 1 3.44 2.75a4 4 0 0 1-1.16 4.33"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="M235.38 98.53A11.82 11.82 0 0 0 225 90.29l-59.45-5.14a4 4 0 0 1-3.32-2.44L139 27.36a11.95 11.95 0 0 0-22.06 0l-23.2 55.35a4 4 0 0 1-3.32 2.44L31 90.29a12 12 0 0 0-6.83 21.07l45.1 39.35a4 4 0 0 1 1.28 4L57 213.22a11.88 11.88 0 0 0 4.67 12.48a11.76 11.76 0 0 0 13.19.53l51.1-31a3.89 3.89 0 0 1 4.08 0l51.1 31a12 12 0 0 0 17.86-13l-13.52-58.54a4 4 0 0 1 1.28-4l45.1-39.35a11.89 11.89 0 0 0 3.52-12.81m-8.78 6.8l-45.1 39.35a12 12 0 0 0-3.82 11.8L191.2 215a4 4 0 0 1-1.56 4.2a3.86 3.86 0 0 1-4.35.17l-51.1-31a11.88 11.88 0 0 0-12.38 0l-51.1 31a3.86 3.86 0 0 1-4.35-.17a4 4 0 0 1-1.56-4.2l13.52-58.54a12 12 0 0 0-3.82-11.8l-45.1-39.33a4 4 0 0 1-1.18-4.33a4 4 0 0 1 3.44-2.75l59.45-5.14a12 12 0 0 0 10-7.31l23.22-55.36a4 4 0 0 1 7.32 0l23.22 55.36a12 12 0 0 0 10 7.31l59.45 5.14a4 4 0 0 1 3.44 2.75a4 4 0 0 1-1.16 4.33"/></svg></div>
                            <div class="rating_empty" style="width: ${item.item.rating * 10}%;"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="m234.5 114.38l-45.1 39.36l13.51 58.6a16 16 0 0 1-23.84 17.34l-51.11-31l-51 31a16 16 0 0 1-23.84-17.34l13.49-58.54l-45.11-39.42a16 16 0 0 1 9.11-28.06l59.46-5.15l23.21-55.36a15.95 15.95 0 0 1 29.44 0L166 81.17l59.44 5.15a16 16 0 0 1 9.11 28.06Z"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="m234.5 114.38l-45.1 39.36l13.51 58.6a16 16 0 0 1-23.84 17.34l-51.11-31l-51 31a16 16 0 0 1-23.84-17.34l13.49-58.54l-45.11-39.42a16 16 0 0 1 9.11-28.06l59.46-5.15l23.21-55.36a15.95 15.95 0 0 1 29.44 0L166 81.17l59.44 5.15a16 16 0 0 1 9.11 28.06Z"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="m234.5 114.38l-45.1 39.36l13.51 58.6a16 16 0 0 1-23.84 17.34l-51.11-31l-51 31a16 16 0 0 1-23.84-17.34l13.49-58.54l-45.11-39.42a16 16 0 0 1 9.11-28.06l59.46-5.15l23.21-55.36a15.95 15.95 0 0 1 29.44 0L166 81.17l59.44 5.15a16 16 0 0 1 9.11 28.06Z"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="m234.5 114.38l-45.1 39.36l13.51 58.6a16 16 0 0 1-23.84 17.34l-51.11-31l-51 31a16 16 0 0 1-23.84-17.34l13.49-58.54l-45.11-39.42a16 16 0 0 1 9.11-28.06l59.46-5.15l23.21-55.36a15.95 15.95 0 0 1 29.44 0L166 81.17l59.44 5.15a16 16 0 0 1 9.11 28.06Z"/></svg><svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256" class="rating_icon"><path fill="currentColor" d="m234.5 114.38l-45.1 39.36l13.51 58.6a16 16 0 0 1-23.84 17.34l-51.11-31l-51 31a16 16 0 0 1-23.84-17.34l13.49-58.54l-45.11-39.42a16 16 0 0 1 9.11-28.06l59.46-5.15l23.21-55.36a15.95 15.95 0 0 1 29.44 0L166 81.17l59.44 5.15a16 16 0 0 1 9.11 28.06Z"/></svg></div>
                        </div>
                        <span>${item.item.rating}</span>
                    </div>

                    <div class="info">
                        ${commentHtml}
                    </div>
                    <div class="movie-footer">
                        <div class="star">
                            <h4></h4>
                            <ul>
                                <li class="neodb">
                                    <a href="/go/?target=${btoa(String(item.item.id))}" target="_blank" rel="noreferrer noopener nofollow">
                                        <img src="/assets/images/movie/neodbsocial.jpg" loading="lazy" alt="NeoDB" no-view>
                                    </a>
                                </li>
                                ${externalResourcesHtml}
                            </ul>
                        </div>
                        <div class="search-item">
                            ${categorySearch}
                        </div>
                    </div>
                </div>
            </div>
            `;
            content.innerHTML += html;
        });
        // 移除 .movie 的 min-height
        document.querySelector('.movie').classList.add('min-height-auto');
    }

    function loadNextPage() {
        currentPage++;
        fetchData(currentPage, currentCategory).then(data => {
            displayData(data);
            if (currentPage< totalPages) {
                loadMoreButton.disabled = false;
            } else {
                loadMoreButton.disabled = true;
            }
        });
    }

    loadMoreButton.addEventListener('click', (event) => {
        event.preventDefault(); // 阻止默认行为
        loadMoreButton.disabled = true; // 禁用按钮，防止重复点击
        loadNextPage();
    });

    genreItems.forEach(item => {
        item.addEventListener('click', (event) => {
            event.preventDefault();
            currentPage = 1;
            currentCategory = event.target.getAttribute('data-category');
            genreItems.forEach(el => el.classList.remove('is-active'));
            event.target.classList.add('is-active');
            content.innerHTML = '';
            document.querySelector('.movie').classList.remove('min-height-auto');
            fetchData(currentPage, currentCategory).then(data => {
                displayData(data);
                totalPages = data.pages;
                if (currentPage< totalPages) {
                    loadMoreButton.disabled = false;
                } else {
                    loadMoreButton.disabled = true;
                }
                document.querySelector('.movie').classList.add('min-height-auto');
            });
        });
    });

    // 初始化第一页内容
    fetchData(currentPage, currentCategory).then(data => {
        displayData(data);
        totalPages = data.pages;
        if (currentPage< totalPages) {
            loadMoreButton.disabled = false;
        } else {
            loadMoreButton.disabled = true;
        }
    });
</script>

<script type="text/javascript" src="/assets/js/lazyload.iife.min.js?v=18.0.0"></script>

<script>
    var lazyLoadInstance = new LazyLoad({
        // Your custom settings go here
    });
</script>

<script>
    // 常规模式
    const normalScreen = document.querySelector('.normal-screen');
    const movie = document.querySelector('.movie');
    normalScreen.addEventListener('click', () => {
        movie.classList.toggle('movie-normal');

    });

    // 网页全屏
    const webFullscreen = document.querySelector('.web-full-screen');
    const headerDesktop = document.querySelector('.desktop');
    const moviePage = document.querySelector('.movie-page');
    const movieTitle = document.querySelector('.movie-title');
    const category = document.querySelector('.category');
    const moviesVideo = document.querySelector('.movies_video');
    const toggleFullscreen = document.querySelector('.toggle-full-screen');
    webFullscreen.addEventListener('click', () => {
        movie.classList.add('movie-mt');
        headerDesktop.classList.add('movie-hide-header');
        moviePage.classList.add('movie-page');
        movieTitle.classList.add('movie-hide-title');
        category.classList.add('category_hidden');
        moviesVideo.classList.add('movies_video_mt');
        toggleFullscreen.classList.add('exit-full-screen');
        // 加载下一页
        loadNextPage();
    });
    toggleFullscreen.addEventListener('click', () => {
        movie.classList.remove('movie-mt');
        headerDesktop.classList.remove('movie-hide-header');
        moviePage.classList.remove('movie-page');
        movieTitle.classList.remove('movie-hide-title');
        category.classList.remove('category_hidden');
        moviesVideo.classList.remove('movies_video_mt');
        toggleFullscreen.classList.remove('exit-full-screen');
    });

    // 浏览器全屏
    const fullscreenBtn = document.querySelector('.browser-full-screen');

    // 点击切换全屏
    fullscreenBtn.addEventListener('click', browserFullscreen);

    // 按键监听
    document.addEventListener('keydown', function(e) {
        if (e.keyCode == 27 || e.keyCode == 122) {
            exitFullscreen();
        }
    });

    // 监听全屏变化
    document.addEventListener('fullscreenchange', function() {
        if (document.fullscreenElement) {
            movie.classList.add('movie-mt');
            headerDesktop.classList.add('movie-hide-header');
            moviePage.classList.add('movie-page');
            movieTitle.classList.add('movie-hide-title');
        } else {
            movie.classList.remove('movie-mt');
            headerDesktop.classList.remove('movie-hide-header');
            moviePage.classList.remove('movie-page');
            movieTitle.classList.remove('movie-hide-title');
            toggleFullscreen.classList.remove('exit-full-screen');
        }
    });

    // 切换全屏
    function browserFullscreen() {
        if (!document.fullscreenElement) {
            // 进入全屏
            document.documentElement.requestFullscreen();

            // 添加样式 class
            movie.classList.add('movie-mt');
            headerDesktop.classList.add('movie-hide-header');
            moviePage.classList.add('movie-page');
            movieTitle.classList.add('movie-hide-title');
            category.classList.add('category_hidden');
            moviesVideo.classList.add('movies_video_mt');
            // 加载下一页
            loadNextPage();
        } else {
            // 退出全屏
            exitFullscreen();
            movie.classList.remove('movie-mt');
            headerDesktop.classList.remove('movie-hide-header');
            moviePage.classList.remove('movie-page');
            movieTitle.classList.remove('movie-hide-title');
            category.classList.remove('category_hidden');
            moviesVideo.classList.remove('movies_video_mt');
            toggleFullscreen.classList.remove('exit-full-screen');
        }
    }

    // 退出全屏
    function exitFullscreen() {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
        }

        // 移除样式 class
        movie.classList.remove('movie-mt');
        headerDesktop.classList.remove('movie-hide-header');
        moviePage.classList.remove('movie-page');
        movieTitle.classList.remove('movie-hide-title');
        category.classList.remove('category_hidden');
        moviesVideo.classList.remove('movies_video_mt');
        toggleFullscreen.classList.remove('exit-full-screen');
    }
</script>

{{ end }}
