function getData(){var xhr=new XMLHttpRequest;xhr.open("get","https://v2.jinrishici.com/one.json",!0),xhr.onreadystatechange=function(){if(4===xhr.readyState){var result=JSON.parse(xhr.responseText),title=document.getElementById("poemTitle"),poemSentence=document.getElementById("poemSentence"),poem_info=document.getElementById("poem_info");title.innerHTML='《<a href="https://www.google.com/search?q='+result.data.origin.author+" "+result.data.origin.title+'" target="_blank" rel="noopener noreferrer">'+result.data.origin.title+"</a>》：",poemSentence.innerHTML='「<a href="https://www.google.com/search?q='+result.data.content+'" target="_blank" rel="noopener noreferrer">'+result.data.content+"</a>」",poem_info.innerHTML="【"+result.data.origin.dynasty+"】"+result.data.origin.author}},xhr.send()}function getTotal(){var totalUrl;fetch("https://memos.eallion.com/api/memo/amount?creatorId=101").then(response=>response.json()).then(data=>{var memosCount;document.getElementById("memosCount").innerHTML=data.data}).catch(err=>{})}window.onload=getData(),window.onload=getTotal();var memo={host:"https://demo.usememos.com/",limit:"10",creatorId:"101",domId:"#memos"};if(void 0!==memos)for(var key in memos)memos[key]&&(memo[key]=memos[key]);var limit=memo.limit,memos=memo.host,localUrl="https://static.eallion.com/memos.json",remoteUrl=memos+"api/memo?creatorId="+memo.creatorId+"&rowStatus=NORMAL",page=1,offset=10,nextLength=0,nextDom="",memoDom=document.querySelector(memo.domId),load='<button class="load-btn button-load">努力加载中……</button>';if(memoDom){memoDom.insertAdjacentHTML("afterend",load),getFirstList();var btn=document.querySelector("button.button-load");btn.addEventListener("click",(function(){btn.textContent="努力加载中……",updateHTMl(nextDom),nextLength<limit?document.querySelector("button.button-load").remove():getNextList()}))}function getFirstList(){var memoUrl_first=localUrl+"?t="+Date.parse(new Date);fetch(memoUrl_first).then(res=>res.json()).then(resdata=>{var nowLength;updateHTMl(resdata.data),resdata.data.length<limit?document.querySelector("button.button-load").remove():(page++,offset=limit*(page-1),getNextList())})}function getNextList(){var memoUrl_next;fetch(remoteUrl+"&limit="+limit+"&offset="+offset).then(res=>res.json()).then(resdata=>{nextDom=resdata.data,nextLength=nextDom.length,page++,offset=limit*(page-1),nextLength<1&&document.querySelector("button.button-load").remove()})}function updateHTMl(data){var memoResult="",resultAll="";const TAG_REG=/#([^\s#]+?) /g,B23_REG=/<a href="https:\/\/b23\.tv\/([a-z|A-Z|0-9]{7})\/">.*<\/a>/g,BILIBILI_REG=/<a\shref="https:\/\/www\.bilibili\.com\/video\/((av[\d]{1,10})|(BV([\w]{10})))\/?">.*<\/a>/g,YOUTUBE_REG=/<a href="https:\/\/www\.youtube\.com\/watch\?v\=([a-z|A-Z|0-9]{11})\">.*<\/a>/g;marked.setOptions({breaks:!0,smartypants:!0,langPrefix:"language-"});for(var i=0;i<data.length;i++){var memoContREG=data[i].content.replace(TAG_REG,"<span class='tag-span'><a target='_blank' rel='noopener noreferrer' href='https://memos.eallion.com/u/101?tag=$1'>#$1</a></span> ");if(memoContREG=marked.parse(pangu.spacing(memoContREG)).replace(BILIBILI_REG,"<div class='video-wrapper'><iframe src='//player.bilibili.com/player.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%;'></iframe></div>").replace(YOUTUBE_REG,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen title='YouTube Video'></iframe></div>"),data[i].resourceList&&data[i].resourceList.length>0){for(var resourceList=data[i].resourceList,imgUrl="",resUrl="",resImgLength=0,j=0;j<resourceList.length;j++){var resType=resourceList[j].type.slice(0,5);"image"==resType&&(imgUrl+='<img loading="lazy" src="'+memos+"o/r/"+resourceList[j].id+"/"+resourceList[j].filename+'"/>',resImgLength+=1),"image"!==resType&&(resUrl+='<a target="_blank" rel="noreferrer" href="'+memos+"o/r/"+resourceList[j].id+"/"+resourceList[j].filename+'">'+resourceList[j].filename+"</a>")}if(imgUrl){var resImgGrid="";if(1!==resImgLength)var resImgGrid="grid grid-"+resImgLength;memoContREG+='<div class="resimg '+resImgGrid+'">'+imgUrl+"</div></div>"}resUrl&&(memoContREG+='<p class="datasource">'+resUrl+"</p>")}memoResult+='<li class="timeline"><div class="talks__content"><div class="talks__text"><div class="talks__userinfo"><div>Charles Chin</div><div><svg viewBox="0 0 24 24" aria-label="认证账号" class="talks__verify"><g><path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"></path></g></svg></div><div class="talks__id">@eallion</div></div><p>'+memoContREG+'</p></div><div class="talks__meta"><small class="talks__date">'+moment(1e3*data[i].createdTs).twitter()+' • 来自「<a href="https://memos.eallion.com/m/'+data[i].id+'" target="_blank">Memos</a>」</small></div></div></li>'}var memoBefore,memoAfter="</ul>";resultAll='<ul class="talks">'+memoResult+"</ul>",memoDom.insertAdjacentHTML("beforeend",resultAll),document.querySelector("button.button-load").textContent="加载更多"}