window.addEventListener("load",(()=>{new MastodonApi({container_body_id:"mt-body",default_theme:"auto",instance_url:"https://api.eallion.com/gotosocial",timeline_type:"profile",user_id:"01RVAVVGAPXR989VKK1BQV6BFS",profile_name:"@eallion",hashtag_name:"",toots_limit:"20",hide_unlisted:!1,hide_reblog:!1,hide_replies:!0,hide_preview_link:!1,hide_emojos:!0,markdown_blockquote:!1,text_max_lines:"0",link_see_more:"See more posts at GoToSocial"})}));const MastodonApi=function(t){this.DEFAULT_THEME=t.default_theme||"auto",this.INSTANCE_URL=t.instance_url,this.USER_ID=t.user_id||"",this.PROFILE_NAME=this.USER_ID?t.profile_name:"",this.TIMELINE_TYPE=t.timeline_type||"local",this.HASHTAG_NAME=t.hashtag_name||"",this.TOOTS_LIMIT=t.toots_limit||"20",this.HIDE_UNLISTED=void 0!==t.hide_unlisted&&t.hide_unlisted,this.HIDE_REBLOG=void 0!==t.hide_reblog&&t.hide_reblog,this.HIDE_REPLIES=void 0!==t.hide_replies&&t.hide_replies,this.HIDE_PREVIEW_LINK=void 0!==t.hide_preview_link&&t.hide_preview_link,this.HIDE_EMOJOS=void 0!==t.hide_emojos&&t.hide_emojos,this.MARKDOWN_BLOCKQUOTE=void 0!==t.markdown_blockquote&&t.markdown_blockquote,this.TEXT_MAX_LINES=t.text_max_lines||"0",this.LINK_SEE_MORE=t.link_see_more,this.FETCHED_DATA={},this.mtBodyContainer=document.getElementById(t.container_body_id),this.buildTimeline()};MastodonApi.prototype.buildTimeline=async function(){this.setTheme(),await this.getTimelineData(),this.mtBodyContainer.innerHTML="";for(let t in this.FETCHED_DATA.timeline)("public"==this.FETCHED_DATA.timeline[t].visibility||!this.HIDE_UNLISTED&&"unlisted"==this.FETCHED_DATA.timeline[t].visibility)&&(this.HIDE_REBLOG&&this.FETCHED_DATA.timeline[t].reblog||this.HIDE_REPLIES&&this.FETCHED_DATA.timeline[t].in_reply_to_id||this.appendToot(this.FETCHED_DATA.timeline[t],Number(t)));if(""===this.mtBodyContainer.innerHTML)this.mtBodyContainer.setAttribute("role","none"),this.mtBodyContainer.innerHTML='<div class="mt-error"><span class="mt-error-icon">üì≠</span><br/><strong>Sorry, no toots to show</strong><br/><div class="mt-error-message">Got '+this.FETCHED_DATA.timeline.length+' toots from the server but due to the "hide filters" applied, no toot is shown</div></div>';else if(this.LINK_SEE_MORE){let t="";"profile"===this.TIMELINE_TYPE?t=this.PROFILE_NAME:"hashtag"===this.TIMELINE_TYPE?t="tags/"+this.HASHTAG_NAME:"local"===this.TIMELINE_TYPE&&(t="public/local");let e='<div class="mt-footer"><a href="https://m.eallion.com/@eallion" class="btn" target="_blank" rel="nofollow noopener noreferrer">'+this.LINK_SEE_MORE+"</a></div>";this.mtBodyContainer.parentNode.insertAdjacentHTML("beforeend",e)}this.mtBodyContainer.addEventListener("click",(function(i){"article"!=i.target.localName&&"article"!=i.target.offsetParent.localName&&"img"!=i.target.localName||t(i),"button"==i.target.localName&&"spoiler-link"==i.target.className&&e(i)})),this.mtBodyContainer.addEventListener("keydown",(function(e){"Enter"===e.key&&"article"==e.target.localName&&t(e)}));const t=function(t){let e=t.target.closest(".mt-toot").dataset.location;"a"!==t.target.localName&&"span"!==t.target.localName&&"button"!==t.target.localName&&"toot-preview-image"!==t.target.parentNode.className&&e&&window.open(e,"_blank")},e=function(t){const e=t.target.nextSibling;"img"===e.localName?(t.target.parentNode.classList.remove("toot-media-spoiler"),t.target.style.display="none"):(e.classList.contains("spoiler-text-hidden")||e.classList.contains("spoiler-text-visible"))&&("Show more"==t.target.textContent?(e.classList.remove("spoiler-text-hidden"),e.classList.add("spoiler-text-visible"),t.target.setAttribute("aria-expanded","true"),t.target.textContent="Show less"):(e.classList.remove("spoiler-text-visible"),e.classList.add("spoiler-text-hidden"),t.target.setAttribute("aria-expanded","false"),t.target.textContent="Show more"))}},MastodonApi.prototype.setTheme=function(){const t=function(t){document.documentElement.setAttribute("data-theme",t)};if("auto"===this.DEFAULT_THEME){let e=window.matchMedia("(prefers-color-scheme: dark)");e.matches?t("dark"):t("light"),e.addEventListener("change",(e=>{e.matches?t("dark"):t("light")}))}else t(this.DEFAULT_THEME)},MastodonApi.prototype.getTimelineData=async function(){return new Promise(((t,e)=>{let i={};"profile"===this.TIMELINE_TYPE?i.timeline=`${this.INSTANCE_URL}/api/v1/accounts/${this.USER_ID}/statuses?limit=${this.TOOTS_LIMIT}`:"hashtag"===this.TIMELINE_TYPE?i.timeline=`${this.INSTANCE_URL}/api/v1/timelines/tag/${this.HASHTAG_NAME}?limit=${this.TOOTS_LIMIT}`:"local"===this.TIMELINE_TYPE&&(i.timeline=`${this.INSTANCE_URL}/api/v1/timelines/public?local=true&limit=${this.TOOTS_LIMIT}`),this.HIDE_EMOJOS||(i.emojos=this.INSTANCE_URL+"/api/v1/custom_emojis");const o=Object.entries(i).map((([t,i])=>async function(t){const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch the following URL: "+t+"<hr>Error status: "+e.status+"<hr>Error message: "+e.statusText);return await e.json()}(i).then((e=>({[t]:e}))).catch((i=>(e(new Error("Something went wrong fetching data")),this.mtBodyContainer.innerHTML='<div class="mt-error"><span class="mt-error-icon">‚ùå</span><br/><strong>Sorry, request failed:</strong><br/><div class="mt-error-message">'+i.message+"</div></div>",this.mtBodyContainer.setAttribute("role","none"),{[t]:[]})))));Promise.all(o).then((e=>{this.FETCHED_DATA=e.reduce(((t,e)=>({...t,...e})),{}),t()}))}))},MastodonApi.prototype.appendToot=function(t,e){this.mtBodyContainer.insertAdjacentHTML("beforeend",this.assambleToot(t,e))},MastodonApi.prototype.assambleToot=function(t,e){let i,o,a,s,n,r,l,d,c;t.reblog?(s=t.reblog.url,i='<a href="'+t.reblog.account.url+'" class="mt-avatar mt-avatar-boosted" style="background-image:url('+t.reblog.account.avatar+');" rel="nofollow noopener noreferrer" target="_blank"><div class="mt-avatar mt-avatar-booster" style="background-image:url('+t.account.avatar+');"></div><span class="visually-hidden">'+t.account.username+" avatar</span></a>",o='<div class="mt-user"><a href="'+t.reblog.account.url+'" rel="nofollow noopener noreferrer" target="_blank"><div class="mt-nick">Charles Chin</div><div class="mt-id">@eallion@eallion.com</div><span class="visually-hidden"> post</span></a></div>',n=this.formatDate(t.reblog.created_at)):(s=t.url,l=t.replies_count,c=t.favourites_count,d=t.reblogs_count,i='<a href="'+t.account.url+'" class="mt-avatar" style="background-image:url('+t.account.avatar+');" rel="nofollow noopener noreferrer" target="_blank"><span class="visually-hidden">'+t.account.username+" avatar</span></a>",o='<div class="mt-user"><a href="'+t.account.url+'" rel="nofollow noopener noreferrer" target="_blank"><div class="mt-nick">Charles Chin</div><div class="mt-id">@eallion@eallion.com</div></a><span class="visually-hidden"> post</span></div>',n=this.formatDate(t.created_at),r=t.id);let m="";if("0"!==this.TEXT_MAX_LINES&&(m="truncate",document.documentElement.style.setProperty("--text-max-lines",this.TEXT_MAX_LINES)),""!==t.spoiler_text){let e=imgReg(this.formatTootText(t.content));a='<div class="toot-text">'+t.spoiler_text+' <button type="button" class="spoiler-link" aria-expanded="false">Show more</button><div class="spoiler-text-hidden">'+e+"</div></div>"}else if(t.reblog&&""!==t.reblog.content&&""!==t.reblog.spoiler_text){let e=imgReg(this.formatTootText(t.reblog.content));a='<div class="toot-text">'+t.reblog.spoiler_text+' <button type="button" class="spoiler-link" aria-expanded="false">Show more</button><div class="spoiler-text-hidden">'+e+"</div></div>"}else if(t.reblog&&""!==t.reblog.content&&""===t.reblog.spoiler_text){a='<div class="toot-text '+m+'"><div>'+imgReg(this.formatTootText(t.content))+"</div></div>"}else{a='<div class="toot-text '+m+'"><div>'+imgReg(this.formatTootText(t.content))+"</div></div>"}let h="";if(t.media_attachments.length>0)for(let e in t.media_attachments)h=this.placeMedias(t.media_attachments[e],t.sensitive);if(t.reblog&&t.reblog.media_attachments.length>0)for(let e in t.reblog.media_attachments)h=this.placeMedias(t.reblog.media_attachments[e],t.reblog.sensitive);let p="";!this.HIDE_PREVIEW_LINK&&t.card&&(p=this.placePreviewLink(t.card));let v="",_="";if(t.poll){for(let e in t.poll.options)_+="<li>"+t.poll.options[e].title+"</li>";v='<div class="toot-poll"><ul>'+_+"</ul></div>"}const g='<div class="toot-date"><a href="'+s+'" rel="nofollow noopener noreferrer" tabindex="-1" target="_blank">'+n+"</a></div>";let u='<div class="toot-reply"><a href="'+s+'" rel="nofollow noopener noreferrer" tabindex="-1" target="_blank" title="ÂõûÂ§ç" alt="ÂõûÂ§ç"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M136.309 189.836L312.313 37.851C327.72 24.546 352 35.348 352 56.015v82.763c129.182 10.231 224 52.212 224 183.548c0 61.441-39.582 122.309-83.333 154.132c-13.653 9.931-33.111-2.533-28.077-18.631c38.512-123.162-3.922-169.482-112.59-182.015v84.175c0 20.701-24.3 31.453-39.687 18.164L136.309 226.164c-11.071-9.561-11.086-26.753 0-36.328zm-128 36.328L184.313 378.15C199.7 391.439 224 380.687 224 359.986v-15.818l-108.606-93.785A55.96 55.96 0 0 1 96 207.998a55.953 55.953 0 0 1 19.393-42.38L224 71.832V56.015c0-20.667-24.28-31.469-39.687-18.164L8.309 189.836c-11.086 9.575-11.071 26.767 0 36.328z"/></svg></a>'+l+"</div>",E='<div class="toot-favourite"><a href="'+s+'" rel="nofollow noopener noreferrer" tabindex="-1" target="_blank" title="ÂñúÊ¨¢" alt="ÂñúÊ¨¢"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M259.3 17.8L194 150.2L47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103l-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5l105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2L316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></a>'+c+"</div>",f='<div class="toot-retoot"><a href="'+s+'" rel="nofollow noopener noreferrer" tabindex="-1" target="_blank" title="ËΩ¨Âòü" alt="ËΩ¨Âòü"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1280"><path fill="currentColor" d="M1280 1248q0 13-9.5 22.5t-22.5 9.5H288q-8 0-13.5-2t-9-7t-5.5-8t-3-11.5t-1-11.5V640H64q-26 0-45-19T0 576q0-24 15-41l320-384q19-22 49-22t49 22l320 384q15 17 15 41q0 26-19 45t-45 19H512v384h576q16 0 25 11l160 192q7 10 7 21zm640-416q0 24-15 41l-320 384q-20 23-49 23t-49-23l-320-384q-15-17-15-41q0-26 19-45t45-19h192V384H832q-16 0-25-12L647 180q-7-9-7-20q0-13 9.5-22.5T672 128h960q8 0 13.5 2t9 7t5.5 8t3 11.5t1 11.5v600h192q26 0 45 19t19 45z"/></svg></a>'+d+"</div>",T='<div class="emaction"><emoji-reaction class="reactions" reactTargetId="e5n_gts_'+r+'" theme="system" endpoint="https://emaction.e5n.cc"></emoji-reaction></div>';return'<article class="mt-toot" aria-posinset="'+(e+1)+'" aria-setsize="'+this.TOOTS_LIMIT+'" tabindex="0"><div class="mt-header">'+i+o+"</div>"+a+h+v+'<div class="toot-footer">'+g+'<div class="mt-meta">'+u+f+E+"</div>"+T+"</div></article>"},MastodonApi.prototype.formatTootText=function(t){let e=t;return e=this.addTarget2hashtagMention(e),this.HIDE_EMOJOS||(e=this.showEmojos(e,this.FETCHED_DATA.emojos)),this.MARKDOWN_BLOCKQUOTE&&(e=this.replaceHTMLtag(e,"<p>&gt;","</p>","<blockquote><p>","</blockquote></p>")),e},MastodonApi.prototype.addTarget2hashtagMention=function(t){let e=t.replaceAll('rel="tag"','rel="tag" target="_blank"');return e=e.replaceAll('class="u-url mention"','class="u-url mention" target="_blank"'),e},MastodonApi.prototype.showEmojos=function(t,e){if(t.includes(":")){for(const i of e){const e=new RegExp(`\\:${i.shortcode}\\:`,"g");t=t.replace(e,`<img src="${i.url}" class="custom-emoji" alt="Emoji ${i.shortcode}" />`)}return t}return t},MastodonApi.prototype.replaceHTMLtag=function(t,e,i,o,a){if(t.includes(e)){const s=new RegExp(e+"(.*?)"+i,"gi");return t.replace(s,o+"$1"+a)}return t},MastodonApi.prototype.placeMedias=function(t,e){let i=e||!1;return'<div class="toot-media '+(i?"toot-media-spoiler":"")+' img-ratio14_7 loading-spinner">'+(i?'<button class="spoiler-link">Show content</button>':"")+'<img onload="removeSpinner(this)" onerror="removeSpinner(this)" src="'+t.preview_url+'" alt="'+(t.description?t.description:"")+'" loading="lazy" /></div>'},MastodonApi.prototype.placePreviewLink=function(t){return'<a href="'+t.url+'" class="toot-preview-link" target="_blank" rel="noopener noreferrer">'+(t.image?'<div class="toot-preview-image"><img onload="removeSpinner(this)" onerror="removeSpinner(this)" src="'+t.image+'" alt="" loading="lazy" /></div>':'<div class="toot-preview-noImage">üìÑ</div>')+'</div><div class="toot-preview-content">'+(t.provider_name?'<span class="toot-preview-provider">'+t.provider_name+"</span>":"")+'<span class="toot-preview-title">'+t.title+"</span>"+(t.author_name?'<span class="toot-preview-author">By '+t.author_name+"</span>":"")+"</div></a>"},MastodonApi.prototype.formatDate=function(t){let e=new Date(t);return moment(e).twitterLong()};const removeSpinner=function(t){const e="loading-spinner";let i=t.closest("."+e);i&&i.classList.remove(e)};function imgReg(t){if(1){var e=t.indexOf("<img"),i=t.slice(0,e)+'<div class="toot-image-wrapper" view-image>'+t.slice(e),o=(i=i.replace(/(<img[^>]+>)/g,(function(t){return'<div class="toot-images">'+t+"</div>"}))).lastIndexOf("</div>");return i=i.slice(0,o)+"</div>"}}