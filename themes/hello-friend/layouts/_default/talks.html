{{ define "main" }}
<!-- Include only the reset -->
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.3.1/themes/reset-min.css"
    integrity="sha256-t2ATOGCtAIZNnzER679jwcFcKYfLlw01gli6F6oszk8="
    crossorigin="anonymous"
/>
<!-- or include the full Satellite theme -->
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css"
    integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc="
    crossorigin="anonymous"
/>
<div class="posts searchPage searchAlgolia">
    <div id="searchbox" class="searchboxAlgolia">
        <!-- SearchBox widget will appear here -->
    </div>
    <div id="hits" class="hitsAlgolia">
        <!-- Hits widget will appear here -->
    </div>
    <div id="pagination" class="paginationAlgolia">
        <!-- pagination widget will appear here -->
    </div>
</div>
<!-- Algolia for the search only version -->
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>
<script>
    const searchClient = algoliasearch(
        "ZHP6RM1ABL",
        "1d5887e05145f909a97929fe3d4f135a"
    );

    const search = instantsearch({
        indexName: "talk",
        searchClient,
    });

    search.addWidgets([
        instantsearch.widgets.searchBox({
            container: "#searchbox",
        }),

        instantsearch.widgets.hits({
            container: "#hits",
            attribute: "content",
            escapeHTML: false,
            templates: {
                empty: "我没有这样的嘀咕……",
                item(item){
                    return `
                    <section class="timeline">
                        <p>${item._highlightResult.content.value}</p>
                        <time class="date"><small>${item._highlightResult.date.value} ·「${item._highlightResult.from.value}」</small></time>
                    </section>
                    `;
                }
            },
        }),
        instantsearch.widgets.pagination({
            container: "#pagination",
            padding: 2,
            scrollTo: 'header'
        }),
    ]);

    search.start();
</script>

{{ end }}
