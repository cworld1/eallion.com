{{ define "head" }}
  {{ if .Paginator.HasPrev -}}<link rel="prefetch" href="{{ .Paginator.Prev.URL }}">{{- end }}
  {{ if .Paginator.HasNext -}}<link rel="prefetch" href="{{ .Paginator.Next.URL }}">{{- end }}
{{ end }}

{{ define "main" }}
  {{ $isntDefault := not (or (eq (trim $.Site.Params.contentTypeName " ") "posts") (eq (trim $.Site.Params.contentTypeName " ") "")) }}
  {{ $contentTypeName := cond $isntDefault (string $.Site.Params.contentTypeName) "posts" }}

  {{ $PageContext := . }}
  {{ if .IsHome }}
    {{ $PageContext = .Site }}
  {{ end }}
  {{ $paginator := .Paginate (where $PageContext.RegularPages "Type" $contentTypeName) }}

  {{ partial "talks.html" . }}

  <div class="posts">
    {{ range $paginator.Pages }}
    <div class="post on-list">
      <h1 class="post-title"><a href="{{ .Permalink }}">{{ .Title | markdownify }}</a></h1>
      <div class="post-meta">
        {{ if .Date }}
        <span class="post-meta-date">
          <span class="post-meta-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-book" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.8" stroke="#222" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
              <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
              <line x1="3" y1="6" x2="3" y2="19" />
              <line x1="12" y1="6" x2="12" y2="19" />
              <line x1="21" y1="6" x2="21" y2="19" />
            </svg>
          </span>
          <span>
            {{ .Date.Format "2006年01月02日" }}
          </span>
        </span>
        {{ end }}
        
        {{ if $.Site.Params.ShowReadingTime }}
        <span class="post-read-time post-meta-none">
          <span class="post-meta-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.8" stroke="#222" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <circle cx="12" cy="12" r="9" />
              <polyline points="12 7 12 12 15 15" />
            </svg>
          </span>
          <span>{{ .ReadingTime }} {{ $.Site.Params.MinuteReadingTime | default "min read" }}</span>
          <span>，约 {{ .WordCount }} 字</span>
        </span>
        {{ end }}
        <!--
        {{ if .Params.tags }}
        <span class="post-meta-none">
          <svg class="post-meta-icon" width="18" height="18" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.35,2.219h-5.934c-0.115,0-0.225,0.045-0.307,0.128l-8.762,8.762c-0.171,0.168-0.171,0.443,0,0.611l5.933,5.934c0.167,0.171,0.443,0.169,0.612,0l8.762-8.763c0.083-0.083,0.128-0.192,0.128-0.307V2.651C17.781,2.414,17.587,2.219,17.35,2.219M16.916,8.405l-8.332,8.332l-5.321-5.321l8.333-8.332h5.32V8.405z M13.891,4.367c-0.957,0-1.729,0.772-1.729,1.729c0,0.957,0.771,1.729,1.729,1.729s1.729-0.772,1.729-1.729C15.619,5.14,14.848,4.367,13.891,4.367 M14.502,6.708c-0.326,0.326-0.896,0.326-1.223,0c-0.338-0.342-0.338-0.882,0-1.224c0.342-0.337,0.881-0.337,1.223,0C14.84,5.826,14.84,6.366,14.502,6.708"></path>
          </svg>
        </span>
        <span class="post-meta-none">
          {{ range .Params.tags }}
            #<a href="{{ (urlize (printf "tags/%s" . )) | absURL }}/">{{ . }}</a>&nbsp;
          {{ end }}
        </span>
        {{ end }}
        -->
      </div>

      {{ if .Params.feature }}
        {{ if .Params.UseRelativeCover }}
          <img loading='lazy' src="{{ (printf "%s%s" .Permalink .Params.feature ) }}" class="post-cover" >
        {{ else }}
          <img loading='lazy' src="{{ .Params.feature | absURL }}" class="post-cover" >
        {{ end }}
      {{ end }}

      <div class="post-content post-index">
      {{ if .Truncated }}
        {{ .Summary }}
        <span>
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-line-dotted" width="28" height="28" viewBox="0 0 24 24" stroke-width="2.5" stroke="#999" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 12v.01" />
            <path d="M8 12v.01" />
            <path d="M12 12v.01" />
            <path d="M16 12v.01" />
            <path d="M20 12v.01" />
          </svg>
        </span>
        <div><a class="read-more button" href="{{.RelPermalink}}">{{ $.Site.Params.ReadMore | default "Read more" }} <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-up-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2.5" stroke="#222" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
          <path d="M9 7h8v8" />
          <path d="M5 11h8v8" />
        </svg></a></div>
      {{ else }}
        {{ .Content }}
        {{ .Render "path"}}
      {{ end }}
      </div>

    </div>
    {{ end }}

    {{ partial "pagination.html" . }}

  </div>
{{ end }}
